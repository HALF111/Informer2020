Args in experiment:
Namespace(activation='gelu', adapted_batch_size=32, adapted_lr_times=1, attn='prob', batch_size=32, c_out=7, checkpoints='./checkpoints/', cols=None, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', dec_in=7, des='Exp', detail_freq='h', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', enc_in=7, factor=5, features='M', freq='h', gpu=1, inverse=False, itr=1, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', mix=True, model='informer', n_heads=8, num_workers=0, output_attention=False, padding=0, patience=3, pred_len=192, root_path='./data/ETT/', run_test=True, run_train=True, s_layers=[3, 2, 1], seq_len=96, target='OT', test_train_epochs=1, test_train_num=10, train_epochs=6, use_amp=False, use_gpu=True, use_multi_gpu=False)
-------Start iteration 1--------------------------
Use GPU: cuda:1
>>>>>>>start training : informer_ETTm2_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4812035
	speed: 0.0428s/iter; left time: 270.6998s
	iters: 200, epoch: 1 | loss: 0.2175886
	speed: 0.0435s/iter; left time: 271.0139s
	iters: 300, epoch: 1 | loss: 0.1847231
	speed: 0.0495s/iter; left time: 303.4763s
	iters: 400, epoch: 1 | loss: 0.1736613
	speed: 0.0448s/iter; left time: 270.2756s
	iters: 500, epoch: 1 | loss: 0.1740983
	speed: 0.0431s/iter; left time: 255.3994s
	iters: 600, epoch: 1 | loss: 0.2924258
	speed: 0.0431s/iter; left time: 251.0753s
	iters: 700, epoch: 1 | loss: 0.1441932
	speed: 0.0436s/iter; left time: 249.9154s
	iters: 800, epoch: 1 | loss: 0.1958603
	speed: 0.0436s/iter; left time: 245.3974s
	iters: 900, epoch: 1 | loss: 0.1640452
	speed: 0.0445s/iter; left time: 245.7685s
	iters: 1000, epoch: 1 | loss: 0.2009543
	speed: 0.0428s/iter; left time: 232.5254s
Epoch: 1 cost time: 47.2894983291626
Epoch: 1, Steps: 1071 | Train Loss: 0.2373645 Vali Loss: 0.4229334 Test Loss: 0.8780587
Validation loss decreased (inf --> 0.422933).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1398569
	speed: 0.2178s/iter; left time: 1144.9890s
	iters: 200, epoch: 2 | loss: 0.1513094
	speed: 0.0420s/iter; left time: 216.6867s
	iters: 300, epoch: 2 | loss: 0.1438201
	speed: 0.0431s/iter; left time: 218.0435s
	iters: 400, epoch: 2 | loss: 0.1469228
	speed: 0.0430s/iter; left time: 212.9360s
	iters: 500, epoch: 2 | loss: 0.1302376
	speed: 0.0439s/iter; left time: 213.3125s
	iters: 600, epoch: 2 | loss: 0.1039812
	speed: 0.0441s/iter; left time: 209.8056s
	iters: 700, epoch: 2 | loss: 0.1140531
	speed: 0.0437s/iter; left time: 203.6632s
	iters: 800, epoch: 2 | loss: 0.1341559
	speed: 0.0427s/iter; left time: 194.6788s
	iters: 900, epoch: 2 | loss: 0.1206576
	speed: 0.0451s/iter; left time: 200.7602s
	iters: 1000, epoch: 2 | loss: 0.1596080
	speed: 0.0438s/iter; left time: 191.0058s
Epoch: 2 cost time: 46.2704713344574
Epoch: 2, Steps: 1071 | Train Loss: 0.1460919 Vali Loss: 0.5395622 Test Loss: 1.0690765
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1113435
	speed: 0.2001s/iter; left time: 837.5547s
	iters: 200, epoch: 3 | loss: 0.1225694
	speed: 0.0447s/iter; left time: 182.5961s
	iters: 300, epoch: 3 | loss: 0.0855335
	speed: 0.0435s/iter; left time: 173.3419s
	iters: 400, epoch: 3 | loss: 0.0829654
	speed: 0.0440s/iter; left time: 170.8547s
	iters: 500, epoch: 3 | loss: 0.0874538
	speed: 0.0455s/iter; left time: 172.2651s
	iters: 600, epoch: 3 | loss: 0.1602996
	speed: 0.0471s/iter; left time: 173.5143s
	iters: 700, epoch: 3 | loss: 0.1230650
	speed: 0.0430s/iter; left time: 154.1880s
	iters: 800, epoch: 3 | loss: 0.0879961
	speed: 0.0443s/iter; left time: 154.3820s
	iters: 900, epoch: 3 | loss: 0.0981123
	speed: 0.0442s/iter; left time: 149.6634s
	iters: 1000, epoch: 3 | loss: 0.0871553
	speed: 0.0440s/iter; left time: 144.6711s
Epoch: 3 cost time: 47.42896604537964
Epoch: 3, Steps: 1071 | Train Loss: 0.1004815 Vali Loss: 0.5919475 Test Loss: 1.1745504
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0861868
	speed: 0.2022s/iter; left time: 629.6948s
	iters: 200, epoch: 4 | loss: 0.0843619
	speed: 0.0483s/iter; left time: 145.5840s
	iters: 300, epoch: 4 | loss: 0.0986508
	speed: 0.0483s/iter; left time: 140.6999s
	iters: 400, epoch: 4 | loss: 0.0776250
	speed: 0.0458s/iter; left time: 128.7570s
	iters: 500, epoch: 4 | loss: 0.0769443
	speed: 0.0469s/iter; left time: 127.2934s
	iters: 600, epoch: 4 | loss: 0.0748129
	speed: 0.0464s/iter; left time: 121.3737s
	iters: 700, epoch: 4 | loss: 0.0825560
	speed: 0.0468s/iter; left time: 117.7359s
	iters: 800, epoch: 4 | loss: 0.0968174
	speed: 0.0460s/iter; left time: 111.1397s
	iters: 900, epoch: 4 | loss: 0.0694596
	speed: 0.0466s/iter; left time: 107.7831s
	iters: 1000, epoch: 4 | loss: 0.0855286
	speed: 0.0464s/iter; left time: 102.7350s
Epoch: 4 cost time: 49.997766971588135
Epoch: 4, Steps: 1071 | Train Loss: 0.0849027 Vali Loss: 0.5953395 Test Loss: 1.1904111
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>normal testing : informer_ETTm2_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
loading model from checkpoint !!!
test shape: (354, 32, 192, 7) (354, 32, 192, 7)
test shape: (11328, 192, 7) (11328, 192, 7)
mse:0.8779978156089783, mae:0.7214553952217102
Test - cost time: 5.4620442390441895s
>>>>>>>my testing with test-time training : informer_ETTm2_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 13745
loading model from checkpoint !!!
	iters: 100, cost time: 21.107885599136353s
	iters: 200, cost time: 42.421684980392456s
	iters: 300, cost time: 65.0328254699707s
	iters: 400, cost time: 86.8458662033081s
test shape: (429, 32, 192, 7) (429, 32, 192, 7)
test shape: (13728, 192, 7) (13728, 192, 7)
mse:0.3190617859363556, mae:0.4155644476413727
Test - cost time: 94.34588813781738s

